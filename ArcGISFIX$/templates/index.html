<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>FIX$ ArcGIS - Economic Equity Mapping</title>
    
    <!-- ArcGIS JavaScript API -->
    <link rel="stylesheet" href="https://js.arcgis.com/4.28/esri/themes/light/main.css">
    <script src="https://js.arcgis.com/4.28/"></script>
    
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div id="app">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <h1>üó∫Ô∏è FIX$ GeoEquity Dashboard</h1>
                <p>ArcGIS-Powered Economic Justice Mapping</p>
            </div>
            <div class="header-actions">
                <button id="searchStoresBtn" class="btn btn-primary">üîç Search Stores</button>
                <button id="refreshBtn" class="btn btn-secondary">üîÑ Refresh</button>
            </div>
        </header>

        <!-- Main Content -->
        <div class="container">
            <!-- Map View -->
            <div id="viewDiv" class="map-container"></div>

            <!-- Side Panel -->
            <div class="side-panel">
                <!-- Statistics -->
                <div class="stats-card">
                    <h3>üìä Network Statistics</h3>
                    <div class="stat-row">
                        <span class="stat-label">Total Stores:</span>
                        <span class="stat-value" id="totalStores">0</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Avg EJV V1:</span>
                        <span class="stat-value" id="avgEJV_V1">0</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Avg EJV V2:</span>
                        <span class="stat-value" id="avgEJV_V2">0</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Daily Wealth:</span>
                        <span class="stat-value" id="totalWealth">$0</span>
                    </div>
                </div>

                <!-- Legend -->
                <div class="legend-card">
                    <h3>üé® EJV Score Legend</h3>
                    <div class="legend-item">
                        <span class="legend-marker" style="background: #2ecc71;"></span>
                        <span>90-100: Excellent</span>
                    </div>
                    <div class="legend-item">
                        <span class="legend-marker" style="background: #3498db;"></span>
                        <span>80-89: Good</span>
                    </div>
                    <div class="legend-item">
                        <span class="legend-marker" style="background: #f39c12;"></span>
                        <span>70-79: Fair</span>
                    </div>
                    <div class="legend-item">
                        <span class="legend-marker" style="background: #e74c3c;"></span>
                        <span>Below 70: Poor</span>
                    </div>
                </div>

                <!-- Filters -->
                <div class="filter-card">
                    <h3>üîç Filters</h3>
                    <label>
                        <span>Store Type:</span>
                        <select id="typeFilter">
                            <option value="">All Types</option>
                            <option value="supermarket">Supermarket</option>
                            <option value="grocery">Grocery</option>
                            <option value="warehouse_club">Warehouse Club</option>
                            <option value="convenience">Convenience</option>
                            <option value="pharmacy">Pharmacy</option>
                            <option value="restaurant">Restaurant</option>
                        </select>
                    </label>
                    <label>
                        <span>Min EJV Score:</span>
                        <input type="number" id="minEJV" min="0" max="100" value="0">
                    </label>
                    <button id="applyFilters" class="btn btn-secondary">Apply</button>
                </div>

                <!-- GeoEquity Impact -->
                <div class="geoequity-card">
                    <h3>üåç GeoEquity Impact</h3>
                    <div id="geoequityContent">
                        <p style="color: #999; text-align: center; padding: 20px;">Add stores to see impact analysis</p>
                    </div>
                </div>

                <!-- Stores List -->
                <div class="stores-list-card">
                    <h3>üìç Stores on Map (<span id="storeCount">0</span>)</h3>
                    <div id="storesList" style="max-height: 300px; overflow-y: auto;">
                        <p style="color: #999; text-align: center; padding: 20px;">No stores added yet</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Search Stores Modal -->
    <div id="searchStoresModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>üîç Search Stores by Location</h2>
            <form id="searchStoresForm">
                <div class="form-group">
                    <label>ZIP Code: <span style="color: red;">*</span></label>
                    <input type="text" name="zip_code" required maxlength="5" placeholder="e.g., 90001">
                </div>
                <div class="form-group">
                    <label>Address (Optional):</label>
                    <input type="text" name="address" placeholder="e.g., Main Street, Los Angeles">
                </div>
                <div class="form-group">
                    <label>Search Radius (km):</label>
                    <input type="number" name="radius" value="5" min="1" max="50" step="1">
                    <small style="color: #666;">1-50 km from location</small>
                </div>
                <div class="form-group">
                    <label>Store Category:</label>
                    <select name="category" required>
                        <option value="all">All Categories</option>
                        <option value="supermarket">Supermarkets</option>
                        <option value="grocery">Grocery Stores</option>
                        <option value="pharmacy">Pharmacies</option>
                        <option value="restaurant">Restaurants</option>
                        <option value="fast_food">Fast Food</option>
                        <option value="cafe">Cafes</option>
                    </select>
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">üîç Search</button>
                    <button type="button" class="btn btn-secondary" id="cancelSearchBtn">Cancel</button>
                </div>
            </form>
            <div id="searchResults" style="display:none; margin-top: 20px;">
                <h3>Found <span id="resultCount">0</span> Stores</h3>
                <div id="searchResultsList"></div>
            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html>
